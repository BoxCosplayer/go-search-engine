<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>go - Admin Users</title>
  <link rel="search" type="application/opensearchdescription+xml" title="go" href="{{ url_for('opensearch_description') }}">
  <style>
    :root {
      --bg: #0d1117;
      --panel: #161b22;
      --text: #c9d1d9;
      --muted: #8b949e;
      --border: #30363d;
      --accent: #58a6ff;
      --danger: #f85149;
      --success: #3fb950;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      min-height: 100vh;
      background: var(--bg);
      color: var(--text);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, 'Helvetica Neue', Arial, 'Noto Sans', 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol';
      line-height: 1.5;
      display: flex;
      justify-content: center;
      padding: 2rem 1rem;
    }

    a {
      color: var(--accent);
      text-decoration: none;
    }

    a:hover {
      text-decoration: underline;
    }

    .wrap {
      width: min(900px, 100%);
    }

    .page-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 1rem;
      margin-bottom: 1.5rem;
    }

    h1 {
      margin: 0;
      font-size: clamp(1.6rem, 2.4vw, 2.1rem);
    }

    .page-header a {
      padding: .5rem 1rem;
      border-radius: 8px;
      border: 1px solid var(--border);
      background: var(--panel);
      color: var(--text);
      font-weight: 600;
      transition: border-color .2s ease, background-color .2s ease;
    }

    .page-header a:hover {
      background: rgba(88, 166, 255, .14);
      border-color: var(--accent);
      text-decoration: none;
    }

    .card {
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 1.5rem;
      box-shadow: 0 2px 12px rgba(0, 0, 0, .25);
      margin-bottom: 1.5rem;
    }

    form label {
      display: block;
      text-align: left;
      margin-bottom: 1rem;
      font-weight: 600;
    }

    input[type="text"],
    input[type="password"] {
      width: 100%;
      margin-top: .35rem;
      font-size: 1rem;
      padding: .6rem .75rem;
      border-radius: 8px;
      border: 1px solid var(--border);
      background: #0b1320;
      color: var(--text);
      outline: none;
    }

    input:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(88, 166, 255, .25);
    }

    button {
      padding: .6rem .9rem;
      border-radius: 8px;
      border: 1px solid transparent;
      background: var(--accent);
      color: #0b0f14;
      font-size: .95rem;
      font-weight: 600;
      cursor: pointer;
      transition: filter .2s ease;
    }

    button:hover {
      filter: brightness(1.08);
    }

    .danger {
      background: var(--danger);
      color: #fff;
    }

    .muted {
      color: var(--muted);
    }

    .flash {
      margin-bottom: 1rem;
      padding: .75rem 1rem;
      border-radius: 8px;
      border: 1px solid;
    }

    .flash.error {
      border-color: rgba(248, 81, 73, .4);
      background: rgba(248, 81, 73, .15);
      color: #ffb4ae;
    }

    .flash.success {
      border-color: rgba(63, 185, 80, .4);
      background: rgba(63, 185, 80, .15);
      color: #b4f5c4;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: 12px;
      overflow: hidden;
    }

    th,
    td {
      padding: .75rem .6rem;
      border-bottom: 1px solid var(--border);
      text-align: left;
      vertical-align: middle;
    }

    thead th {
      color: var(--muted);
      font-weight: 600;
      background: rgba(255, 255, 255, .02);
    }

    tbody tr:nth-child(even) td {
      background: rgba(255, 255, 255, .02);
    }

    .actions {
      display: flex;
      flex-wrap: wrap;
      gap: .5rem;
      align-items: center;
    }

    .inline-form {
      display: flex;
      align-items: center;
      gap: .5rem;
      margin: 0;
    }

    .inline-form input[type="password"] {
      min-width: 10rem;
    }

    @media (max-width: 720px) {
      .page-header {
        flex-direction: column;
        align-items: stretch;
        text-align: center;
      }

      .page-header a {
        text-align: center;
      }

      .actions,
      .inline-form {
        flex-direction: column;
        align-items: stretch;
      }

      .inline-form input[type="password"] {
        width: 100%;
      }
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="page-header">
      <h1>Admin users</h1>
      <a href="{{ url_for('admin.admin_home') }}">Back to Admin</a>
    </div>

    {% if error %}
    <div class="flash error">{{ error }}</div>
    {% endif %}

    {% if message %}
    <div class="flash success">{{ message }}</div>
    {% endif %}

    <div class="card">
      <h2>Add user</h2>
      <form method="post" action="{{ url_for('admin.admin_users_add') }}">
        <label>Username
          <input name="username" type="text" autocomplete="username" required>
        </label>
        <label>Password
          <input name="password" type="password" autocomplete="new-password" required>
        </label>
        <button type="submit">Add user</button>
      </form>
    </div>

    <h2>Existing users</h2>
    <table>
      <thead>
        <tr>
          <th>Username</th>
          <th>Status</th>
          <th>Created</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for user in users %}
        <tr>
          <td><code>{{ user['username'] }}</code></td>
          <td>{{ 'Active' if user['is_active'] else 'Disabled' }}</td>
          <td class="muted">{{ user['created_at'] }}</td>
          <td>
            <div class="actions">
              <form class="inline-form" method="post" action="{{ url_for('admin.admin_users_password') }}">
                <input type="hidden" name="username" value="{{ user['username'] }}">
                <input name="password" type="password" placeholder="New password" autocomplete="new-password" required>
                <button type="submit">Set password</button>
              </form>
              <form method="post" action="{{ url_for('admin.admin_users_toggle') }}">
                <input type="hidden" name="username" value="{{ user['username'] }}">
                <input type="hidden" name="is_active" value="{{ '0' if user['is_active'] else '1' }}">
                <button type="submit">{{ 'Disable' if user['is_active'] else 'Enable' }}</button>
              </form>
              <form method="post" action="{{ url_for('admin.admin_users_delete') }}">
                <input type="hidden" name="username" value="{{ user['username'] }}">
                <button class="danger" type="submit"
                  onclick="return confirm('Delete {{ user['username'] }}?')">Delete</button>
              </form>
            </div>
          </td>
        </tr>
        {% endfor %}
        {% if not users %}
        <tr>
          <td colspan="4" class="muted">No admin users yet.</td>
        </tr>
        {% endif %}
      </tbody>
    </table>
  </div>
</body>

</html>
